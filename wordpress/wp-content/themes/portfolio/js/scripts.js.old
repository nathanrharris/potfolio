var $j = jQuery.noConflict();

var audio_swoosh = new Audio('/wp-content/themes/portfolio/sounds/220191__gameaudio__space-swoosh-brighter.wav');
var audio_hit = new Audio('/wp-content/themes/portfolio/sounds/50221__tblo__high-hit.wav');
var audio_slide = new Audio('/wp-content/themes/portfolio/sounds/171321__swidmark__fast-swoosh.wav');

/************************/
/*   HOME PAGE          */
/************************/

$j(document).ready(function() {
  
  $j(window).scroll(function() { scroll_handler(); });

  

  $j(function() {
    $j.scrollify({
      section : ".pane-wrapper",
      scrollSpeed: 2000,
      scrollbars: false,
      before:function() {     $j.scrollify.disable();
                              audio_swoosh.play();
                              $j('.icon, .title').fadeOut(150); 
                        },
      after:function(id)  {   $j('.icon').fadeIn(300); 
                          
                              if (id==0) {
                                $j('.title').html('<span class="title-name">Nathan<br />Harris</span>');
                              }
                              if (id==1) {
                                $j('.title').html('Portfolio');
                              }
                              if (id==2) {
                                $j('.title').html('Skills');
                              }
                              if (id==3) {
                                $j('.title').html('Hire Me');
                              }

                              setTimeout(function() { $j('.title').show(); 
                                                      audio_hit.play();
                                                      $j.scrollify.enable();
                                                    }, 300); 
                          },
    });
  });

  $j('#icons #icon-1').click(function() {  $j.scrollify.move(0); });
  $j('#icons #icon-2').click(function() {  $j.scrollify.move(1); });
  $j('#icons #icon-3').click(function() {  $j.scrollify.move(2); });
  $j('#icons #icon-4').click(function() {  $j.scrollify.move(3); });
});


function scroll_handler() {
  var pos = $j(window).scrollTop();
  var h = $j(window).height();

  if (pos > (h * .9)) {
    $j('#icons').css('top', '65px');
  } else {
    $j('#icons').css('top', 'calc(33vh - 45px)');
  }

  $j('.home #pane-portfolio-1').css('background-position-y', (pos/-3));
  $j('.home #pane-portfolio-2').css('background-position-y', (pos/-1));
  $j('.home #pane-portfolio-3').css('background-position-y', (pos/-2));

  $j('.home #pane-skills-1').css('background-position-y', (pos/-3));
  $j('.home #pane-skills-2').css('background-position-y', (pos/-1));
  $j('.home #pane-skills-3').css('background-position-y', (pos/-2));

  $j('.home #pane-hire-1').css('background-position-y', (pos/-3));
  $j('.home #pane-hire-2').css('background-position-y', (pos/-1));
  $j('.home #pane-hire-3').css('background-position-y', (pos/-2));
}


/************************/
/*   SKILLS PAGE        */
/************************/

$j(document).ready(function() {

  $j('.skill-filter').click(function() {
    $j('html, body').animate({scrollTop: ($j('#pane-' + $j(this).attr('id')).offset().top)}, 1000);
  });

});

/************************/
/*   PORTFOLIO PAGE     */
/************************/

$j(document).ready(function() {

  $j('#portfolio-grid').isotope({
    itemSelector: '.grid-item',
    layoutMode: 'packery',
  });

  $j('.portfolio-filter').click(function() {

    Cookies.set('filter', $j(this).attr('id'), {expires:2}); 
    $j('#filter a').removeClass('active'); 
    $j(this).addClass('active');
    
    if ($j(this).attr('id') == 'all') {
      $j('#portfolio-grid').isotope({ filter: '*'});
    } else {
      $j('#portfolio-grid').isotope({ filter: '.grid-item.' + $j(this).attr('id')});
    }
  });

  var portfolio_filter = Cookies.get('filter');

  if (portfolio_filter == '') {
    portfolio_filter = 'all';
  }

  $j("#" + portfolio_filter).addClass('active');
  $j("#" + portfolio_filter).click();
  
});

/************************/
/*   HOME SLIDER CODE   */
/************************/

/* home slider variables */
var current_slide = 1;
var slide_count = 99;
var animating = false;

function next_slide() {
  slide_count = $j('.portfolio-item').length;

  event.preventDefault();

  if (animating == true) {
    return;
  }

  animating = true;

  audio_slide.play();

  var next_slide = current_slide + 1;

  if (next_slide > slide_count) { next_slide = 1; }

  $j('#portfolio-item-' + next_slide).css('left', '100%');
  $j('#portfolio-item-' + next_slide).css('opacity', '0');
  
  $j('#portfolio-item-' + next_slide + ' .screenshot-title ').css('left', '1000px');
  $j('#portfolio-item-' + next_slide + ' .screenshot-url ').css('left', '1000px');
  
  $j('#portfolio-item-' + next_slide + ' .screenshot-title ').css('opacity', '0');
  $j('#portfolio-item-' + next_slide + ' .screenshot-url ').css('opacity', '0');

  $j('.arrow').animate({'opacity' : '0'}, 300);
  
  $j('.role').delay(200).animate({'opacity' : '0'}, 300);
  $j('.tasks').delay(300).animate({'opacity' : '0'}, 300);
  $j('.tech').delay(400).animate({'opacity' : '0'}, 300);

  $j('#portfolio-item-' + current_slide + ' .screenshot-title ').delay(300).animate({'left' : '-1000px', 'opacity' : '0'}, 600);
  $j('#portfolio-item-' + current_slide + ' .screenshot-url ').delay(500).animate({'left' : '-1000px', 'opacity' : '0'}, 600);

  $j('#portfolio-item-' + current_slide).delay(600).animate({'left' : '-100%', 'opacity' : '0'}, 600);
  $j('#portfolio-item-' + next_slide).delay(600).animate({'left' : '0', 'opacity' : '1'}, 600);
  
  $j('#portfolio-item-' + next_slide + ' .screenshot-title ').delay(500).animate({'left' : '0px', 'opacity' : '1'}, 600);
  $j('#portfolio-item-' + next_slide + ' .screenshot-url ').delay(600).animate({'left' : '0', 'opacity' : '1'}, 600);
  
  $j('.role').delay(800).animate({'opacity' : '1'}, 600);
  $j('.tasks').delay(900).animate({'opacity' : '1'}, 600);
  $j('.tech').delay(1000).animate({'opacity' : '1'}, 600);
  
  $j('.arrow').delay(1800).animate({'opacity' : '1'}, 100);

  current_slide = next_slide;

  setTimeout(function() { animating = false; }, 2000);
}

function prev_slide() {
  slide_count = $j('.portfolio-item').length;

  event.preventDefault();

  if (animating == true) {
    return;
  }

  animating = true;

  audio_slide.play();

  var next_slide = current_slide - 1;

  if (next_slide == 0) { next_slide = slide_count; }

  $j('#portfolio-item-' + next_slide).css('left', '-100%');
  $j('#portfolio-item-' + next_slide).css('opacity', '0');
  
  $j('#portfolio-item-' + next_slide + ' .screenshot-title ').css('left', '-1000px');
  $j('#portfolio-item-' + next_slide + ' .screenshot-url ').css('left', '-1000px');
  
  $j('#portfolio-item-' + next_slide + ' .screenshot-title ').css('opacity', '0');
  $j('#portfolio-item-' + next_slide + ' .screenshot-url ').css('opacity', '0');

  $j('.arrow').animate({'opacity' : '0'}, 300);
  
  $j('.role').delay(200).animate({'opacity' : '0'}, 300);
  $j('.tasks').delay(300).animate({'opacity' : '0'}, 300);
  $j('.tech').delay(400).animate({'opacity' : '0'}, 300);

  $j('#portfolio-item-' + current_slide + ' .screenshot-title ').delay(300).animate({'left' : '1000px', 'opacity' : '0'}, 600);
  $j('#portfolio-item-' + current_slide + ' .screenshot-url ').delay(500).animate({'left' : '1000px', 'opacity' : '0'}, 600);

  $j('#portfolio-item-' + current_slide).delay(600).animate({'left' : '100%', 'opacity' : '0'}, 600);
  $j('#portfolio-item-' + next_slide).delay(600).animate({'left' : '0', 'opacity' : '1'}, 600);
  
  $j('#portfolio-item-' + next_slide + ' .screenshot-title ').delay(500).animate({'left' : '0px', 'opacity' : '1'}, 600);
  $j('#portfolio-item-' + next_slide + ' .screenshot-url ').delay(600).animate({'left' : '0', 'opacity' : '1'}, 600);
  
  $j('.role').delay(800).animate({'opacity' : '1'}, 600);
  $j('.tasks').delay(900).animate({'opacity' : '1'}, 600);
  $j('.tech').delay(1000).animate({'opacity' : '1'}, 600);
  
  $j('.arrow').delay(1800).animate({'opacity' : '1'}, 100);

  current_slide = next_slide;

  setTimeout(function() { animating = false; }, 2000);
}

/*******************************/
/*   PROJECT PAGE SLIDER CODE  */
/*******************************/

/* project page slider variables */
var project_current_array  = -1;
var project_next_array     = -1;
  
var project_current_index  = -1;
var project_next_index     = -1

var project_current_id     = -1;
var project_next_id        = -1

var project_animating = false;
var project_filter = 'all';

$j(document).ready(function() {
  /*
  project_filter = Cookies.get('filter');

  if (project_filter == '') {
    project_filter = 'all';
  }

  $j("#" + project_filter).addClass('active');

  console.log("SETTING FILTER: " + project_filter);

  project_current_array = window['project_slides_' + project_filter];

  console.log("SETTING CURRENT ARRAY: ");
  console.log(project_current_array);

  project_current_index = 0; 
  project_current_id = project_current_array[project_current_index]; 

  console.log("SETTING CURRENT SLIDE: ");
  console.log(project_current_id);
 
  $j('.project-filter').click(function() {
    project_new_filter($j(this).attr('id'));
  });
*/
});

function project_next_slide() {
  event.preventDefault();
  
  if (project_animating == true) {
    return;
  }

  project_animating = true;
  
  console.log('Project Next Slide');

  slide_count = project_current_array.length;

  console.log('Slide count: ' + slide_count);

  project_next_index = project_current_index + 1;

  if (project_next_index == slide_count) {
    project_next_index = 0;
  }

  project_next_id = project_current_array[project_next_index];

  console.log("NEXT ID: " + project_next_id);

  project_left_out(project_current_id);

  project_left_in(project_next_id);

  project_current_index = project_next_index;
  project_current_id = project_next_id;
  
  setTimeout(function() { project_animating = false; }, 2000);
}

function project_prev_slide() {
  event.preventDefault();
  
  if (project_animating == true) {
    return;
  }

  project_animating = true;
  
  console.log('Project previous Slide');

  slide_count = project_current_array.length;

  console.log('Slide count: ' + slide_count);

  project_next_index = project_current_index - 1;

  if (project_next_index == -1) {
    project_next_index = slide_count - 1;
  }

  project_next_id = project_current_array[project_next_index];

  console.log("NEXT ID: " + project_next_id);

  project_right_out(project_current_id);

  project_right_in(project_next_id);

  project_current_index = project_next_index;
  project_current_id = project_next_id;
  
  setTimeout(function() { project_animating = false; }, 2000);
}

function project_new_filter(filter) {

  if (filter == project_filter) {
    return;
  }

  project_filter = filter; 

  console.log('FILTERING PROJECTS: ' + filter);

  Cookies.set('filter', filter, {expires: 2});
  
  $j('#filter a').removeClass('active'); 
  $j('#' + filter).addClass('active');

  console.log("Current Array");
  console.log(project_current_array);
 
  console.log("Current Item: " + project_current_id);
 
  project_next_array = window['project_slides_' + filter];

  console.log("Next Array");
  console.log(project_next_array);

  console.log("Next Item : " + project_next_array[0]); 
 
  if (project_current_id == project_next_array[0]) {
    console.log("No scroll. Just update array and index");
  } else {
    console.log("Scroll to first item");
  
    project_left_out(project_current_id);
    project_left_in(project_next_array[0]);
  }

  project_current_array = project_next_array;
  project_current_index = 0;
  project_current_id = project_current_array[project_current_index];

}

function project_left_out(id) {
  console.log("Moving out left: " + id);
  var item = $j('#project-item-' + id);

  $j('.arrow').animate({'opacity' : '0'}, 300);

  $j('.role').delay(200).animate({'opacity' : '0'}, 300);
  $j('.tasks').delay(300).animate({'opacity' : '0'}, 300);
  $j('.tech').delay(400).animate({'opacity' : '0'}, 300);
  
  item.find(' .screenshot-title ').delay(300).animate({'left' : '-1000px', 'opacity' : '0'}, 600);
  item.find(' .screenshot-url ').delay(400).animate({'left' : '-1000px', 'opacity' : '0'}, 600);

  item.find(' .project-screenshot-1 ').delay(600).animate({'margin-left' : '-600px', 'opacity' : 0}, 600);
  item.find(' .project-screenshot-2 ').delay(600).animate({'margin-left' : '-200px', 'opacity' : 0}, 600);

  item.delay(600).animate({'left' : '-100%', 'opacity' : '0'}, 600);
}

function project_left_in(id) {
  console.log("Moving in left: " + id);
 
  var item = $j('#project-item-' + id);
  
  item.css('left', '100%');
  item.css('opacity', '0');
  
  item.find(' .screenshot-title ').css('left', '1000px');
  item.find(' .screenshot-url ').css('left', '1000px');

  item.find(' .project-screenshot-1 ').css('margin-left', '2500px');
  item.find(' .project-screenshot-2 ').css('margin-left', '5000px');
  
  item.find(' .screenshot-title ').css('opacity', '0');
  item.find(' .screenshot-url ').css('opacity', '0');
  
  item.find(' .project-screenshot-1 ').css('opacity', '0');
  item.find(' .project-screenshot-2 ').css('opacity', '0');

  item.delay(600).animate({'left' : '0', 'opacity' : '1'}, 600);
  
  item.find(' .screenshot-title ').delay(500).animate({'left' : '0px', 'opacity' : '1'}, 600);
  item.find(' .screenshot-url ').delay(600).animate({'left' : '0', 'opacity' : '1'}, 600);
  
  item.find(' .project-screenshot-1 ').delay(300).animate({'margin-left' : '0px', 'opacity' : '1'}, 600);
  item.find(' .project-screenshot-2 ').delay(400).animate({'margin-left' : '0px', 'opacity' : '1'}, 600);
  
  $j('.role').delay(800).animate({'opacity' : '1'}, 600);
  $j('.tasks').delay(900).animate({'opacity' : '1'}, 600);
  $j('.tech').delay(1000).animate({'opacity' : '1'}, 600);
  
  $j('.arrow').delay(1200).animate({'opacity' : '1'}, 100);
}

function project_right_out(id) {
  console.log("Moving out right: " + id);

  var item = $j('#project-item-' + id);
  
  $j('.arrow').animate({'opacity' : '0'}, 300);

  $j('.role').delay(200).animate({'opacity' : '0'}, 300);
  $j('.tasks').delay(300).animate({'opacity' : '0'}, 300);
  $j('.tech').delay(400).animate({'opacity' : '0'}, 300);
  
  item.find(' .screenshot-title ').delay(300).animate({'left' : '1000px', 'opacity' : '0'}, 600);
  item.find(' .screenshot-url ').delay(500).animate({'left' : '1000px', 'opacity' : '0'}, 600);

  item.find(' .project-screenshot-1 ').delay(600).animate({'margin-left' : '600px', 'opacity' : 0}, 600);
  item.find(' .project-screenshot-2 ').delay(600).animate({'margin-left' : '200px', 'opacity' : 0}, 600);

  item.delay(600).animate({'left' : '100%', 'opacity' : '0'}, 600);
}

function project_right_in(id) {
  console.log("Moving in right: " + id);
 
  var item = $j('#project-item-' + id);

  item.css('left', '-100%');
  item.css('opacity', '0');
  
  item.find(' .screenshot-title ').css('left', '-1000px');
  item.find(' .screenshot-url ').css('left', '-1000px');

  item.find(' .project-screenshot-1 ').css('margin-left', '-400px');
  item.find(' .project-screenshot-2 ').css('margin-left', '-200px');

  item.find(' .screenshot-title ').css('opacity', '0');
  item.find(' .screenshot-url ').css('opacity', '0');
  
  item.find(' .project-screenshot-1 ').css('opacity', '0');
  item.find(' .project-screenshot-2 ').css('opacity', '0');

  item.delay(600).animate({'left' : '0', 'opacity' : '1'}, 600);

  item.find(' .screenshot-title ').delay(400).animate({'left' : '0px', 'opacity' : '1'}, 600);
  item.find(' .screenshot-url ').delay(500).animate({'left' : '0', 'opacity' : '1'}, 600);

  item.find(' .project-screenshot-1 ').delay(200).animate({'margin-left' : '0px', 'opacity' : '1'}, 1000);
  item.find(' .project-screenshot-2 ').delay(200).animate({'margin-left' : '0px', 'opacity' : '1'}, 1200);

  $j('.role').delay(800).animate({'opacity' : '1'}, 600);
  $j('.tasks').delay(900).animate({'opacity' : '1'}, 600);
  $j('.tech').delay(1000).animate({'opacity' : '1'}, 600);
  
  $j('.arrow').delay(1200).animate({'opacity' : '1'}, 100);
}
